{"version":3,"file":"godmode-diagnostic-browser.element-BlEzaRVy.js","sources":["../../../assets/src/workspace/godmode/views/godmode-diagnostic-browser.element.ts"],"sourcesContent":["import { css, customElement, html, repeat, state, when } from \"@umbraco-cms/backoffice/external/lit\";\nimport { UmbLitElement } from \"@umbraco-cms/backoffice/lit-element\";\nimport { Diagnostic, DiagnosticGroup, DiagnosticSection, GodModeService } from \"../../../api\";\nimport { tryExecuteAndNotify } from \"@umbraco-cms/backoffice/resources\";\nimport { UUIInputEvent, UUISelectEvent } from \"@umbraco-cms/backoffice/external/uui\";\n\n@customElement('godmode-diagnostic-browser')\nexport class GodModeDiagnosticBrowserElement extends UmbLitElement {\n    @state()\n    diagnostics: Array<DiagnosticGroup> = [];\n\n    @state()\n    currentGroup?: DiagnosticGroup = undefined;\n\n    @state()\n    filteredSections: Array<DiagnosticSection> = [];\n\n    @state()\n    currentGroupId: string = '';\n\n    @state()\n    searchKey: string = '';\n\n    @state()\n    searchValue: string = '';\n\n    configurationGroups: Array<Option> = [];\n\n    constructor() {\n        super();\n        this.#loadDiagnostics();\n    }\n\n    async #loadDiagnostics() {\n        const { data } = await tryExecuteAndNotify(this, GodModeService.getUmbracoManagementApiV1GodModeGetEnvironmentDiagnostics());\n\n        if (data) {\n            this.diagnostics = data;\n\n            const groups = data.map(group => {\n                return { name: group.title, value: group.id.toString(), selected: group.id === 0 }\n            });\n\n            groups.unshift({ name: 'Select', value: '', selected: false });\n\n            this.configurationGroups = groups;\n            this.currentGroup = this.diagnostics[0];\n            this.currentGroupId = this.diagnostics[0]?.id.toString();\n            this.filteredSections = this.currentGroup.sections;\n        }\n    }\n\n    #configurationChange(event: UUISelectEvent) {\n        const newGroup = this.diagnostics.find(x => x.id.toString() == event.target.value as string);\n        if (newGroup) {\n            this.currentGroup = newGroup;\n            this.currentGroupId = newGroup.id.toString();\n            this.filteredSections = newGroup.sections;\n            this.searchKey = \"\";\n            this.searchValue = \"\";\n        }\n    }\n\n    #setSearchKey(event: UUIInputEvent) {\n        const value = event.target.value as string;\n        this.searchKey = value;\n        this.#filterValues();\n    }\n\n    #setSearchValue(event: UUIInputEvent) {\n        const value = event.target.value as string;\n        this.searchValue = value;\n        this.#filterValues();\n    }\n\n    #filterValues() {\n      if (this.currentGroup) {\n        if (this.searchKey !== '' || this.searchValue !== '') {\n            this.filteredSections = structuredClone(this.currentGroup.sections);\n            this.filteredSections?.forEach(section => {\n                section.diagnostics = section.diagnostics.filter(x => this.#filter(x));\n            });\n          }\n          else {\n            this.filteredSections = this.currentGroup?.sections;\n          }\n        }\n    }\n\n    #filter(diag: Diagnostic) {\n        let found: boolean = false;\n        if (this.searchKey !== '') {\n            found = diag.key.toLowerCase().includes(this.searchKey.toLowerCase());\n        }\n\n        if (this.searchValue !== '') {\n            found = diag.value.toLowerCase().includes(this.searchValue.toLowerCase());\n        }\n\n        if (this.searchKey !== '' && this.searchValue !== '') {\n            found = diag.key.toLowerCase().includes(this.searchKey.toLowerCase()) && diag.value.toLowerCase().includes(this.searchValue.toLowerCase());\n        }\n\n        return found;\n    }\n\n    render() {\n        return html`\n            <umb-body-layout>\n                <godmode-header name=\"Diagnostics\" slot=\"header\"></godmode-header>\n\n                <uui-box>\n                    <div class=\"grid\">\n                        <div>\n                            <uui-label for=\"search-key\">Search Names:</uui-label>\n                            <uui-input\n                                id=\"search-key\"\n                                placeholder=\"Filter by name\"\n                                .value=${this.searchKey}\n                                @input=${this.#setSearchKey}>\n                            </uui-input>\n                        </div>\n                        <div>\n                            <uui-label for=\"search-value\">Search Values:</uui-label>\n                            <uui-input\n                                id=\"search-value\"\n                                placeholder=\"Filter by value\"\n                                .value=${this.searchValue}\n                                @input=${this.#setSearchValue}>\n                            </uui-input>\n                        </div>\n                        <div>\n                            <uui-label for=\"search-section\">Configuration Group:</uui-label>\n                            <uui-select\n                                id=\"search-section\"\n                                .options=${this.configurationGroups}\n                                @change=${this.#configurationChange}\n                                .value=${this.currentGroupId}>\n                            </uui-select>\n                        </div>\n                    </div>\n                </uui-box>\n\n                ${when(\n                  this.currentGroup !== undefined,\n                  () => html`\n                    <h4>${this.currentGroup?.title}</h4>\n      \n                    ${repeat(\n                        this.filteredSections,\n                        (group) => group.heading,\n                        (group) => group.diagnostics.length !== 0 ?\n                            html`\n                                <uui-box headline=${group.heading}>\n                                    <uui-table>\n                                          <uui-table-head>\n                                              <uui-table-head-cell style=\"width: 30%\">Key</uui-table-head-cell>\n                                              <uui-table-head-cell style=\"width: 70%\">Value</uui-table-head-cell>\n                                          </uui-table-head>\n\n                                          ${repeat(\n                                              group.diagnostics,\n                                              (diagnostic) => diagnostic.key,\n                                              (diagnostic) => html`\n                                                  <uui-table-row>\n                                                      <uui-table-cell>${diagnostic.key}</uui-table-cell>\n                                                      <uui-table-cell>${diagnostic.value}</uui-table-cell>\n                                                  </uui-table-row>\n                                              `\n                                          )}\n                                      </uui-table>\n                                  </uui-box>\n                              ` : html``\n                      )}`,\n                    () => html`<uui-loader></uui-loader>`\n                )}\n                    \n            </umb-body-layout>\n        `\n    }\n\n    static styles = [\n        css`\n            .grid {\n                display: grid;\n                grid-template-columns: repeat(3, 1fr);\n                gap: 20px;\n\n                div {\n                    display: flex;\n                    flex-direction: column;\n                    align-items: flex-start;\n                }\n            }\n\n            uui-box {\n                margin-bottom: 20px;\n            }\n        `\n    ]\n}\n\nexport default GodModeDiagnosticBrowserElement;\n\ndeclare global {\n    interface HTMLElementTagNameMap {\n        'godmode-diagnostic-browser': GodModeDiagnosticBrowserElement;\n    }\n}\n"],"names":["_loadDiagnostics","loadDiagnostics_fn","_configurationChange","configurationChange_fn","_setSearchKey","setSearchKey_fn","_setSearchValue","setSearchValue_fn","_filterValues","filterValues_fn","_filter","filter_fn","GodModeDiagnosticBrowserElement","UmbLitElement","__privateAdd","__privateMethod","html","when","_a","repeat","group","diagnostic","data","tryExecuteAndNotify","GodModeService","groups","event","newGroup","x","value","section","_b","diag","found","css","__decorateClass","state","customElement","GodModeDiagnosticBrowserElement$1"],"mappings":";;;;;;;;;;;;;;;2DAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAOa,IAAAC,IAAN,cAA8CC,EAAc;AAAA,EAqB/D,cAAc;AACJ,aAIJC,EAAA,MAAAd,CAAA,GAmBNc,EAAA,MAAAZ,CAAA,GAWAY,EAAA,MAAAV,CAAA,GAMAU,EAAA,MAAAR,CAAA,GAMAQ,EAAA,MAAAN,CAAA,GAcAM,EAAA,MAAAJ,CAAA,GAhFA,KAAA,cAAsC,IAGL,KAAA,eAAA,QAGjC,KAAA,mBAA6C,IAGpB,KAAA,iBAAA,IAGL,KAAA,YAAA,IAGE,KAAA,cAAA,IAEtB,KAAA,sBAAqC,IAIjCK,EAAA,MAAKf,GAALC,CAAA,EAAA,KAAA,IAAA;AAAA,EACJ;AAAA,EA2EA,SAAS;AACE,WAAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yCAW0B,KAAK,SAAS;AAAA,yCACdD,QAAKX,GAAaC,CAAA,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yCAQlB,KAAK,WAAW;AAAA,yCAChBU,QAAKT,GAAeC,CAAA,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CAOlB,KAAK,mBAAmB;AAAA,0CACzBQ,QAAKb,GAAoBC,CAAA,CAAA;AAAA,yCAC1B,KAAK,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAM1Cc;AAAA,MACA,KAAK,iBAAiB;AAAA,MACtB,MAAA;;AAAM,eAAAD;AAAA,2BACEE,IAAA,KAAK,iBAAL,gBAAAA,EAAmB,KAAK;AAAA;AAAA,sBAE5BC;AAAA,UACE,KAAK;AAAA,UACL,CAACC,MAAUA,EAAM;AAAA,UACjB,CAACA,MAAUA,EAAM,YAAY,WAAW,IACpCJ;AAAA,oDACwBI,EAAM,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CAOrBD;AAAA,YACEC,EAAM;AAAA,YACN,CAACC,MAAeA,EAAW;AAAA,YAC3B,CAACA,MAAeL;AAAA;AAAA,wEAEUK,EAAW,GAAG;AAAA,wEACdA,EAAW,KAAK;AAAA;AAAA;AAAA,UAAA,CAG7C;AAAA;AAAA;AAAA,kCAGTL;AAAA,QAAA,CACX;AAAA;AAAA,MACH,MAAMA;AAAA,IAAA,CACT;AAAA;AAAA;AAAA;AAAA,EAIb;AAqBJ;AAvKUhB,IAAA,oBAAA,QAAA;AAAAC,IAAgB,iBAAG;;AACf,QAAA,EAAE,MAAAqB,MAAS,MAAMC,EAAoB,MAAMC,EAAe,2DAA2D;AAE3H,MAAIF,GAAM;AACN,SAAK,cAAcA;AAEb,UAAAG,IAASH,EAAK,IAAI,CAASF,OACtB,EAAE,MAAMA,EAAM,OAAO,OAAOA,EAAM,GAAG,SAAY,GAAA,UAAUA,EAAM,OAAO,EAAE,EACpF;AAEM,IAAAK,EAAA,QAAQ,EAAE,MAAM,UAAU,OAAO,IAAI,UAAU,IAAO,GAE7D,KAAK,sBAAsBA,GACtB,KAAA,eAAe,KAAK,YAAY,CAAC,GACtC,KAAK,kBAAiBP,IAAA,KAAK,YAAY,CAAC,MAAlB,gBAAAA,EAAqB,GAAG,YACzC,KAAA,mBAAmB,KAAK,aAAa;AAAA,EAC9C;AACJ;AAEAhB,IAAA,oBAAA,QAAA;AAAAC,IAAoB,SAACuB,GAAuB;AAClC,QAAAC,IAAW,KAAK,YAAY,KAAK,CAAAC,MAAKA,EAAE,GAAG,SAAS,KAAKF,EAAM,OAAO,KAAe;AAC3F,EAAIC,MACA,KAAK,eAAeA,GACf,KAAA,iBAAiBA,EAAS,GAAG,SAAS,GAC3C,KAAK,mBAAmBA,EAAS,UACjC,KAAK,YAAY,IACjB,KAAK,cAAc;AAE3B;AAEAvB,IAAA,oBAAA,QAAA;AAAAC,IAAa,SAACqB,GAAsB;AAC1B,QAAAG,IAAQH,EAAM,OAAO;AAC3B,OAAK,YAAYG,GACjBd,EAAA,MAAKP,GAALC,CAAA,EAAA,KAAA,IAAA;AACJ;AAEAH,IAAA,oBAAA,QAAA;AAAAC,IAAe,SAACmB,GAAsB;AAC5B,QAAAG,IAAQH,EAAM,OAAO;AAC3B,OAAK,cAAcG,GACnBd,EAAA,MAAKP,GAALC,CAAA,EAAA,KAAA,IAAA;AACJ;AAEAD,IAAA,oBAAA,QAAA;AAAAC,IAAa,WAAG;;AACd,EAAI,KAAK,iBACH,KAAK,cAAc,MAAM,KAAK,gBAAgB,MAC9C,KAAK,mBAAmB,gBAAgB,KAAK,aAAa,QAAQ,IAC7DS,IAAA,KAAA,qBAAA,QAAAA,EAAkB,QAAQ,CAAWY,MAAA;AAC9B,IAAAA,EAAA,cAAcA,EAAQ,YAAY,OAAO,OAAKf,EAAK,MAAAL,GAAAC,CAAA,EAAL,WAAaiB,CAAE,CAAA;AAAA,EAAA,MAIpE,KAAA,oBAAmBG,IAAA,KAAK,iBAAL,gBAAAA,EAAmB;AAGnD;AAEArB,IAAA,oBAAA,QAAA;AAAAC,IAAO,SAACqB,GAAkB;AACtB,MAAIC,IAAiB;AACjB,SAAA,KAAK,cAAc,OACXA,IAAAD,EAAK,IAAI,YAAY,EAAE,SAAS,KAAK,UAAU,aAAa,IAGpE,KAAK,gBAAgB,OACbC,IAAAD,EAAK,MAAM,YAAY,EAAE,SAAS,KAAK,YAAY,aAAa,IAGxE,KAAK,cAAc,MAAM,KAAK,gBAAgB,OAC9CC,IAAQD,EAAK,IAAI,cAAc,SAAS,KAAK,UAAU,YAAY,CAAC,KAAKA,EAAK,MAAM,cAAc,SAAS,KAAK,YAAY,aAAa,IAGtIC;AACX;AAjGSrB,EA8KF,SAAS;AAAA,EACZsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBJ;AA9LAC,EAAA;AAAA,EADCC,EAAM;AAAA,GADExB,EAET,WAAA,eAAA,CAAA;AAGAuB,EAAA;AAAA,EADCC,EAAM;AAAA,GAJExB,EAKT,WAAA,gBAAA,CAAA;AAGAuB,EAAA;AAAA,EADCC,EAAM;AAAA,GAPExB,EAQT,WAAA,oBAAA,CAAA;AAGAuB,EAAA;AAAA,EADCC,EAAM;AAAA,GAVExB,EAWT,WAAA,kBAAA,CAAA;AAGAuB,EAAA;AAAA,EADCC,EAAM;AAAA,GAbExB,EAcT,WAAA,aAAA,CAAA;AAGAuB,EAAA;AAAA,EADCC,EAAM;AAAA,GAhBExB,EAiBT,WAAA,eAAA,CAAA;AAjBSA,IAANuB,EAAA;AAAA,EADNE,EAAc,4BAA4B;AAAA,GAC9BzB,CAAA;AAmMb,MAAA0B,IAAe1B;"}